# FLIR ResearchIR 批量帧数据导出工具

## 简介

这是一个用于自动化批量导出FLIR ResearchIR 4软件中帧数据的AutoHotkey脚本工具。由于FLIR ResearchIR软件本身不提供批量导出功能，需要手动一帧一帧地保存数据，这个工具可以自动化这个重复的过程。

## 功能特点

- 自动化批量导出指定范围的帧数据
- 支持导出为CSV格式（X和Y值）
- 可自定义帧范围（起始帧和结束帧）
- 可自定义保存路径
- 包含坐标获取工具，方便适配不同分辨率的屏幕
- 实时进度显示
- 支持中途取消（ESC键）

## 文件说明

- `FLIR_AutoSave.ahk` - 主脚本，执行批量导出任务
- `CoordinateFinder.ahk` - 坐标获取辅助工具
- `1.jpg`, `2.jpg`, `3.jpg` - 操作流程截图参考
- `README.md` - 本说明文档

## 系统要求

- Windows操作系统
- FLIR ResearchIR 4软件
- AutoHotkey v1.1或更高版本（[下载地址](https://www.autohotkey.com/)）

## 安装步骤

1. 下载并安装AutoHotkey：https://www.autohotkey.com/
2. 下载本项目的所有文件到同一文件夹

## 使用步骤

### 第一步：获取屏幕坐标

由于不同电脑的分辨率和窗口位置可能不同，需要先获取准确的坐标：

1. 打开FLIR ResearchIR软件
2. 打开Profile窗口（显示温度曲线的窗口）
3. 双击运行 `CoordinateFinder.ahk`
4. 按照以下顺序获取各个位置的坐标：

   **a) Save按钮**
   - 将鼠标移到Profile窗口右上角的"Save"按钮
   - 按 `Ctrl+Shift+C`
   - 输入名称：`Save按钮`

   **b) 下一帧箭头按钮**
   - 将鼠标移到底部时间轴上的"下一帧"右箭头按钮
   - 按 `Ctrl+Shift+C`
   - 输入名称：`下一帧箭头按钮`

   **c) 打开保存对话框**
   - 手动点击一次Save按钮，打开"Save As"对话框

   **d) 文件名输入框**
   - 将鼠标移到"File name"输入框
   - 按 `Ctrl+Shift+C`
   - 输入名称：`文件名输入框`

   **e) 文件类型下拉框**
   - 将鼠标移到"Save as type"下拉框
   - 按 `Ctrl+Shift+C`
   - 输入名称：`文件类型下拉框`

   **f) 最终Save按钮**
   - 将鼠标移到对话框中的"Save"按钮
   - 按 `Ctrl+Shift+C`
   - 输入名称：`最终Save按钮`

5. 按 `F1` 查看所有已保存的坐标，代码会自动复制到剪贴板
6. 关闭CoordinateFinder工具（按ESC）

### 第二步：配置主脚本

1. 右键点击 `FLIR_AutoSave.ahk`，选择"Edit Script"（编辑脚本）
2. 找到"配置参数"部分，修改以下设置：

   ```ahk
   ; 帧范围设置
   StartFrame := 1          ; 起始帧号（改为你需要的起始帧）
   EndFrame := 100          ; 结束帧号（改为你需要的结束帧）

   ; 保存路径设置
   SavePath := "C:\FLIR_Export"  ; CSV文件保存目录（改为你的保存路径）
   ```

3. 找到"屏幕坐标设置"部分，粘贴第一步获取的坐标代码
4. 保存脚本（Ctrl+S）

### 第三步：运行批量导出

1. 确保FLIR ResearchIR软件已打开
2. 确保Profile窗口已打开
3. **重要：手动切换到起始帧**（例如，如果设置StartFrame为1，请先切换到第1帧）
4. 双击运行 `FLIR_AutoSave.ahk`
5. 在弹出的确认对话框中点击"是"
6. 等待5秒准备时间
7. 脚本会自动开始批量导出
8. 可以随时按 `ESC` 键中止

## 操作原理

脚本会自动重复以下操作步骤：

1. 点击Profile窗口的"Save"按钮
2. 在保存对话框中选择CSV格式
3. 修改文件名为"Frame_[帧号]"（使用当前帧号）
4. 点击保存按钮
5. 等待文件保存完成
6. 点击底部时间轴的"下一帧"右箭头按钮，切换到下一帧
7. 重复以上步骤直到所有帧都保存完成

**注意**：由于使用箭头按钮切换帧，脚本需要在起始帧开始运行，然后通过点击箭头逐帧前进。这比输入帧号的方式更稳定可靠。

## 快捷键说明

### FLIR_AutoSave.ahk
- `ESC` - 中止批量导出
- `F1` - 显示帮助信息

### CoordinateFinder.ahk
- `Ctrl+Shift+C` - 保存当前鼠标位置坐标
- `F1` - 查看所有已保存坐标并复制代码
- `F2` - 清除所有已保存坐标
- `F3` - 显示帮助信息
- `ESC` - 退出程序

## 常见问题

### 1. 脚本运行后没有反应？
- 检查AutoHotkey是否正确安装
- 确保FLIR软件和Profile窗口已打开
- 检查脚本中的坐标是否正确

### 2. 点击位置不准确？
- 重新使用CoordinateFinder.ahk获取坐标
- 确保获取坐标时FLIR窗口位置与运行脚本时相同
- 建议将FLIR窗口最大化以获得稳定的坐标

### 3. 文件没有保存到指定位置？
- 检查SavePath路径是否正确
- 确保该路径存在且有写入权限
- 检查路径中是否使用了正确的反斜杠

### 4. 保存速度太快或太慢？
- 可以调整脚本中的延迟参数：
  ```ahk
  DelayShort := 300        ; 短延迟（界面响应）
  DelayMedium := 800       ; 中等延迟（对话框打开）
  DelayLong := 1500        ; 长延迟（文件保存）
  ```

### 5. 某些帧保存失败？
- 增加延迟时间，给软件更多响应时间
- 检查磁盘空间是否充足
- 检查帧号是否在有效范围内

## 注意事项

1. **运行前必须手动切换到起始帧**，脚本会从当前帧开始，通过点击右箭头逐帧导出
2. **运行期间请勿移动鼠标或操作电脑**，否则可能干扰脚本执行
3. **首次使用前务必先测试**，建议先设置小范围（如1-5帧）测试是否正常
4. **确保FLIR窗口位置固定**，每次运行时窗口位置应与获取坐标时一致
5. **建议最大化FLIR窗口**，以获得稳定的坐标位置
6. **备份重要数据**，虽然脚本不会修改原始数据，但建议做好备份
7. **确保帧范围正确**，如果当前帧号加上要导出的帧数超过视频总帧数，可能会导致错误

## 技术支持

如有问题或建议，请在GitHub上提交Issue。

## 许可证

本项目采用MIT许可证，可自由使用和修改。

## 更新日志

### v1.1 (2025-11-17)
- 改进：使用右箭头按钮切换帧，替代输入帧号的方式
- 简化了操作流程，提高了稳定性
- 用户需要在运行前手动切换到起始帧
- 更新了使用说明和操作原理

### v1.0 (2025-11-17)
- 初始版本发布
- 支持批量导出帧数据为CSV格式
- 包含坐标获取辅助工具